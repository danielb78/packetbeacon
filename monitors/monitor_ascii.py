#!/usr/bin/env python
#
# monitor_ascii.py - Remote monitor for packetbeacon.py,
# which shows "AHHH MOTHERLAND" every time someone on the
# local network browses the Web unsafely.
#
#
# Author: Patrick F. Wilbur (pdub.net)
#
# Copyright 2019 Patrick F. Wilbur. All Rights Reserved.
#  

import socketserver
import threading
import time

banner = False
banner_until = 0

def ahhh_motherland():
    print("""
',,,,,,,,,,,,,,,,,,,,,,,,';,,,,,,,,,,,,:;',,,,,,,,,,,,,,,,,,
',,,,,,,,,,,,,,,,,,,,,,,;,+##++++##';:,,,,,,';,,,,,,,,,,,,,,
',,,,,,,,,,,,,,,,,,,,,,'++'++++++++++'++++#+;,:',,,,,,,,,,,,
',,,,,,,,,,,,,,,,,,,,,,'++++++++++++++++++++++#,;;,,,,,,,,,,
',,,,,,,,,,,,,,,,,,,,,,#++++++++++++++++++++++++#,+,,,,,,,,,
',,,,,,,,,,,,,,,,,,,,,,#+++++++++++++++++++++++++++,',,,,,,,
+,,,,,,,,,,,,,,,,,,,,,,;++++#+#''###++++++++++++++++:',,,,,,
+';;';,,,,,,,,,,,,,,,,,,++#;;;,:';;;;;;'##+++++++++++#:,,,,,
+;;;;';,,,,,,,,,,,,,,,,,;+;;;;,:;,;;;;;;;;;;'#++++++++##,,,,
+;';;';;';,,,,,,,,,,,,,,,#;;;;#;;'';;;;;;;;;;;;;++++++++,,,,
+';;;;;;;',,,,,,,,,,,,,,,,+@;,,,,,,,,:#+##';;;;;;;+++'++;,,,
',,:;;;;;,,,,,,,,,,,,,,,,:,,:;;;;:,,,,,,:'',;+#';;;;+++++,,,
',,,,,,,,,,,,,,,,,,,,,,,,#''###++';;'+++##;,,;',';;+++++,,,,
',,,,,,,,,,,,,,,,,,,,,,,,+.:##@@@@@@@@@@@#+;;;;;;;;++++#,,,,
',,,,,,,,,,,,,,,,,,,,,,,'+++++++'';::,.:;+#@@@';;;;++;,,,,,,
',,,,,,,,,,,,,,,,,,,,,,,,'@@;,,,,'@@@#,,,,.@@@@@#';,,,,,,,,,
',,,              ,,,,,,,:,:@#,,@##@@@@,,,,;@@@@@@#,,,,,,,,,
',,, AHHH         ,,,,,,,,+++.,,,:#@#,',,,,:@@@@@@@,,,,,,,,,
',,,   MOTHERLAND ,,,,,,,,;,`#,,,@`.#',,,,,#@@@@@@@,,,,,,,,,
',,,              ,,,,,,,:.'#,,,,:::,,,,,,,,#',,:,@,,,,,,,,,
',,,,,,,,,,,,,,,,,,,,,,,,+,,+,,,,,,,,,,,,,,,,,,',';,,,,,,,,,
',,,,,,,,,,,,,,,,,,,,,,,,+,',,,,:,,,,,,,,,,,,,,,,;',,,,,,,,,
',,,,,,,,,,,,,,,,,,,;';;;+,,,.,,,,,,,,,,,,,,,,,++#';;,,,,,,,
',,,,,,,,,,,,,,,:;;;;;;;'+,#',+@,#,,,,,,,,,,,,+.+,;;;;';''''
',,,,,,,,,,,,,,,;;;';;;;;+,.;,'':,,;,,,,,,,,,,+,,+;;;;;';;;;
',,,,,,,,,,,,,,,,::,,,,,,,';@@@@@@',,,,,,,,,,,,,,;;';;;';;;;
',,,,,,,,,,,,,,,,,,,,,,,,,;@@@@@@@@@+,,,,,,,,:,,+'';;;;;;:,,
',,,,,,,,,,,,,,,,,,,,,,,,:#@@@@@@@@@::,,,,,,,;',;;;;:,,,,,,,
',,,,,,,,,,,,,,,,,,,,,,,,,'@#####@@@',,,,,,,,,,#';,,,,,,,,,,
',,,,,,,,,,,,,,,,,,,,,,,,,'@#######:,,,,,,,,,,+''+,,,,,,,,,,
',,,,,,,,,,,,,,,,,,,,,,,,,'#########,,,,,,,,:''''',,,,,,,,,,
',,,,,,,,,,,,,,,,,,,,,,,,,::'######,.,,,,,.#''''''+,,,,,,,,,
',,,,,,,,,,,,,,,,,,,,,,,,,,,#;.`+`++,,,,,'@'''''''':,,,,,,,,
',,,,,,,,,,,,,,,,,,,,,,,,,,+,,,,;;,,,,,,@@''''''''''+,,,,,,,
',,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,#@@''''''''''';+,,,,,,
',,,,,,,,,,,,,,,,,,,,,,,,,,+,,,,,,,,,@@#''+'''''''#..;+':,,,
',,,,,,,,,,,,,,,,,,,,,,,,,:';;,,,','@@'''+'++'''#@,...  '::,
',,,,,,,,,,,,,,,,,,,,,,,,+,:,'@@,,@@+'''+,,,+''#@#;..:;;;..:
',,,,,,,,,,,,,,,,,,,,,,,;,,::+@@'@@''''+,,,#''#@@''+,.....#;
'::::::::::::::::::''#;;++'+++@@@@''''++::;+'#@#''''''+,..;.
####################:;+'+'::'@#@@''''+;;;;+'#@+'''''''''+,.,
###################.+''':;;+'#@+@'''#';:'+'@@'''''''''''''+.
##################+''''+';;#@@'''''+';:''#@@''''''''''''''''
##################'''''';'@@+''''+:;;:;+@@@''''''''''''''''+
#################+'''+,'@@''''''''+;::@@@@''''''''''''''''''
#################'''',@#''''''''''';;@@@@'''''''''''''''''''
################+''''''''''''''''''+@@@@+''''''''''''''''+''
################'''''''''''''''''''''@@+'''''''''''''''''+''
################''''''''''''''''''''''''''''''''''''''''+'''
###############+''''''''''''''''''''''''''''''''''''''''+'''
###############''''''''''''''''''''''''''''''''''''''''+''''
###############''''''''''''''''''''''''''''''''''''
""")

class MyUDPHandler(socketserver.BaseRequestHandler):
    def handle(self):
        global banner,banner_until
        data = self.request[0].strip()
        # print(data)
        banner = True
        banner_until = time.time() + 5
        ahhh_motherland()

if __name__ == "__main__":
    server = socketserver.UDPServer(('', 13337), MyUDPHandler)
    server_thread = threading.Thread(target=server.serve_forever)
    server_thread.daemon = True
    server_thread.start()
    print("now monitoring unsafe web activity...")
    while True:
        if banner and time.time() > banner_until:
            banner = False
            print("\n"*100)
        time.sleep(1)

